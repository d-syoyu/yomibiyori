# 投稿ボタン エラーハンドリング テストシナリオ

## 🧪 テスト環境準備

```bash
cd mobile
npm start
```

その後、iPhoneまたはiPadシミュレータで起動してください。

---

## テストケース一覧

### ✅ テストケース1: 基本的な投稿成功
**手順:**
1. ログインする
2. 今日のお題を選択
3. 下の句を2行入力する
4. 「投稿する」ボタンをタップ

**期待結果:**
- ✅ 「作品を投稿しました」というトーストメッセージが表示される
- ✅ 鑑賞画面に遷移する
- ❌ エラーメッセージが表示されない

---

### ✅ テストケース2: 空の入力で投稿
**手順:**
1. お題選択画面で「詠む」をタップ
2. テキスト入力欄を空のままにする
3. 「投稿する」ボタンをタップ

**期待結果:**
- ✅ ボタンが無効化されている（タップできない）
- OR
- ✅ 「入力内容に誤りがあります」というエラーメッセージが表示される

---

### ✅ テストケース3: ネットワークエラー
**手順:**
1. デバイスの機内モードをONにする（またはWi-Fiを切断）
2. お題を選択
3. 下の句を入力
4. 「投稿する」ボタンをタップ

**期待結果:**
- ✅ 「ネットワークに接続できません」というエラーメッセージが表示される
- ✅ ボタンが再度タップ可能になる（isSubmittingがfalseに戻る）
- ❌ アプリがクラッシュしない

---

### ✅ テストケース4: 1日2回目の投稿（日次制限）
**手順:**
1. すでに今日投稿済みのアカウントでログイン
2. 同じカテゴリのお題を選択
3. 下の句を入力
4. 「投稿する」ボタンをタップ

**期待結果:**
- ✅ 「今日はすでにこのカテゴリに投稿済みです」というエラーメッセージが表示される
- ✅ ボタンが再度タップ可能になる
- ❌ アプリがクラッシュしない

---

### ✅ テストケース5: 認証エラー（トークン期限切れ）
**手順:**
1. ログインする
2. アプリを長時間（数時間以上）放置する
3. お題を選択して投稿しようとする

**期待結果:**
- ✅ 「認証に失敗しました」というエラーメッセージが表示される
- OR
- ✅ ログイン画面に自動的にリダイレクトされる
- ❌ アプリがクラッシュしない

---

### ✅ テストケース6: サーバーエラー（500）
**手順:**
1. バックエンドAPIを停止する（Railway環境の場合）
2. お題を選択して投稿しようとする

**期待結果:**
- ✅ 「サーバーエラーが発生しました」というエラーメッセージが表示される
- ✅ ボタンが再度タップ可能になる
- ❌ アプリがクラッシュしない

---

### ✅ テストケース7: iPad レイアウト
**デバイス:** iPad Air (第5世代) シミュレータ

**手順:**
1. iPadシミュレータで起動
2. プロフィール設定画面を開く
3. 各フィールドを確認

**期待結果:**
- ✅ コンテンツが重ならない
- ✅ 各セクション間に十分な余白がある
- ✅ スクロールが正常に動作する
- ✅ キーボードが表示されてもレイアウトが崩れない
- ✅ 横向き（ランドスケープ）でも正常に表示される

---

## 📝 テスト実行チェックリスト

- [ ] テストケース1: 基本的な投稿成功
- [ ] テストケース2: 空の入力で投稿
- [ ] テストケース3: ネットワークエラー
- [ ] テストケース4: 1日2回目の投稿
- [ ] テストケース5: 認証エラー
- [ ] テストケース6: サーバーエラー
- [ ] テストケース7: iPad レイアウト

---

## 🐛 バグ報告時の情報

エラーが発生した場合は、以下の情報を記録してください：

1. **デバイス情報**
   - デバイス名（例: iPad Air 第5世代）
   - OSバージョン（例: iPadOS 18.0）
   - アプリバージョン

2. **エラー内容**
   - 表示されたエラーメッセージ（スクリーンショット推奨）
   - エラーが発生した画面
   - エラーが発生する前に行った操作

3. **コンソールログ**
   - Xcodeのコンソールログを確認（`[CompositionScreen]` や `[ProfileScreen]` で検索）
   - エラースタックトレースがあればコピー

4. **再現手順**
   - エラーを再現できる手順を詳細に記載

---

## 🚀 テスト自動化（将来的に）

現在は手動テストですが、将来的には以下のツールで自動化できます：

- **Detox**: React Native用のE2Eテストフレームワーク
- **Appium**: クロスプラットフォームのモバイルテストフレームワーク
- **Jest**: ユニットテストとスナップショットテスト

```bash
# 将来的な実装例
npm install --save-dev detox
detox test --configuration ios.sim.debug
```
